<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>控制台</title>
    <link rel="stylesheet" href="/static/common/open-source/element-ui/element-ui-min.css">
    <link rel="stylesheet" href="/static/common/open-source/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/common/common.css">
    <link rel="stylesheet" href="/static/common/component/RanGoDialog.css">
    <link rel="stylesheet" href="/static/system/main/console.css">
    <script src="/static/common/open-source/jquery/jquery.min.js"></script>
    <script src="/static/common/open-source/element-ui/vue.js"></script>
    <script src="/static/common/open-source/element-ui/element-ui.js"></script>
    <script src="/static/common/common.js"></script>
    <script src="/static/common/component/RanGoDialog.js"></script>

</head>
<body>
<div id="consoleApp">
    <div class="console-header">
        <div class="console-header-navbar">
            <div class="console-header-navbar-crumbs">
                <el-breadcrumb separator="/">
                    <el-breadcrumb-item :to="{ path: '/' }">首页</el-breadcrumb-item>
                    <el-breadcrumb-item><a href="/">活动管理</a></el-breadcrumb-item>
                    <el-breadcrumb-item>活动列表</el-breadcrumb-item>
                    <el-breadcrumb-item>活动详情</el-breadcrumb-item>
                </el-breadcrumb>
            </div>
            <div class="console-header-navbar-menu">
                <div class="console-header-navbar-menu-item">
                    <i class="fa fa-cog application-title-icon"></i>
                </div>
                <div class="console-header-navbar-menu-img">
                    <el-avatar shape="square" :size="50" :src="squareUrl"></el-avatar>
                </div>
            </div>
        </div>
        <div>
            <el-tabs v-model="showIFrameId" closable @tab-remove="removeTab">
                <el-tab-pane
                        v-for="(item, index) in editableTabs"
                        :key="item.name"
                        :label="item.title"
                        :name="item.name"
                >
                </el-tab-pane>
            </el-tabs>
        </div>
    </div>
    <div class="console-main">
        <div v-if="showIFrameId==='console'">
            <el-collapse v-model="activeNames" @change="handleChange">
                <el-collapse-item  name="1">
                    <template slot="title">
                        <i class="fa fa-cog application-title-icon"></i>
                        <h3 class="application-title-text">系统管理</h3>
                    </template>
                    <div class="application-container">
                        <el-card shadow="hover" class="application-card application-card-blue" @click.native="addTab('001','机构管理')">
                            <i class="fa fa-sitemap"></i>
                        </el-card>
                        <span>机构管理</span>
                    </div>
                    <div class="application-container">
                        <el-card shadow="hover" class="application-card application-card-orange" @click.native="addTab('002','用户管理')">
                            <i class="fa fa-user"></i>
                        </el-card>
                        <span>用户管理</span>
                    </div>
                    <div class="application-container">
                        <el-card shadow="hover" class="application-card application-card-green" @click.native="addTab('003','角色管理')">
                            <i class="fa fa-address-card"></i>
                        </el-card>
                        <span>角色管理</span>
                    </div>
                    <div class="application-container-array">
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                        <div class="application-container small">
                            <el-card shadow="hover" class="application-card small application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                    </div>
                </el-collapse-item>


                <template v-for="menu in menuList">
                    <el-collapse-item  v-bind:name="menu.id">
                        <template slot="title">
                            <span class="application-title-icon" v-html = 'menu.menuIcon'></span>
                            <h3 class="application-title-text">{{menu.menuName}}</h3>
                        </template>
                        <div class="application-container">
                            <el-card shadow="hover" class="application-card application-card-blue" @click.native="addTab('001','机构管理')">
                                <i class="fa fa-sitemap"></i>
                            </el-card>
                            <span>机构管理</span>
                        </div>
                        <div class="application-container">
                            <el-card shadow="hover" class="application-card application-card-orange" @click.native="addTab('002','用户管理')">
                                <i class="fa fa-user"></i>
                            </el-card>
                            <span>用户管理</span>
                        </div>
                        <div class="application-container">
                            <el-card shadow="hover" class="application-card application-card-green" @click.native="addTab('003','角色管理')">
                                <i class="fa fa-address-card"></i>
                            </el-card>
                            <span>角色管理</span>
                        </div>
                    </el-collapse-item>
                </template>

            </el-collapse>
        </div>

        <template v-for="iFrame in consoleMainIFrames">
            <div v-if="showIFrameId===iFrame.id">
                <iframe v-bind:src="iFrame.url" class="console-main-iframe"></iframe>
            </div>
        </template>
    </div>
</div>



<script>

    try {
        if(window.commonVue === undefined){
            window.commonVue = new Vue({
                el: '#commonVueApp',
                data: function() {
                    return {
                    }
                },
                mounted() {
                },
                methods: {
                    showSuccessMessage(message){
                        this.$notify({title: "成功",message: message,type: "success"});
                    },
                    showWarningMessage(message){
                        this.$notify({title: "警告",message: message,type: "warning"});
                    },
                    showErrorMessage(message){
                        if(!message){
                            message = "系统错误";
                        }
                        this.$notify.error({title: "错误",message: message});
                    }
                }
            });
        }
    }
    catch(err){
    }


    new Vue({
        el: "#consoleApp",
        data: {
            menuList:[],


            showIFrameId: "console",
            consoleMainIFrames:[{
                id: "001",
                url: "/TSUserController/forwordTSUserList"
            }],
            squareUrl: "/test/canvas.png",
            activeNames: ['1'],
            editableTabs: [{
                title: '桌面',
                name: 'console',
            }]
        },
        mounted () {
            this.searchTSMenuList();
        },
        methods: {
            searchTSMenuList(){
                var self = this;
                common.ajax({
                    url:"/TSMenuController/searchMyTSMenuList",
                    data : {},
                    success:function(result){
                        self.menuList = result.object;
                        console.log(result.object);
                    }
                });
            },
            addTab(id,tabName) {
                this.showIFrameId = id;
                this.editableTabs.forEach(function(obj,key,arr){
                    if(obj.name === id){
                        throw 'error';
                    }
                });
                this.editableTabs.push({
                    title: tabName,
                    name: id
                });
                this.consoleMainIFrames.push({

                })
            },




            handleChange(val) {
                console.log(val);
            },

            removeTab(targetName) {
                let tabs = this.editableTabs;
                let activeName = this.showIFrameId;
                if (activeName === targetName) {
                    tabs.forEach((tab, index) => {
                        if (tab.name === targetName) {
                            let nextTab = tabs[index + 1] || tabs[index - 1];
                            if (nextTab) {
                                activeName = nextTab.name;
                            }
                        }
                    });
                }

                this.showIFrameId = activeName;
                this.editableTabs = tabs.filter(tab => tab.name !== targetName);
            }
        }
    });
</script>
</body>
</html>